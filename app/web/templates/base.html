<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="è¿½æ¼«é˜ - ä¸ªäººåŠ¨æ¼«è¿½æ›´ç®¡ç†å¹³å°">
    <title>{% block title %}è¿½æ¼«é˜{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='theme.css') }}?v=3">
    <link rel="stylesheet" href="{{ url_for('static', filename='themes.css') }}?v=2">
    <script>
        /* ç«‹å³åº”ç”¨ä¿å­˜çš„ä¸»é¢˜ï¼Œé˜²æ­¢é¡µé¢é—ªçƒ */
        (function() {
            try {
                const theme = localStorage.getItem('zhuimange-theme') || 'neon-purple';
                const mode = localStorage.getItem('zhuimange-theme-mode') || 'dark';
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const finalMode = mode || (prefersDark ? 'dark' : 'light');
                document.documentElement.setAttribute('data-theme', theme + '-' + finalMode);
            } catch (e) {}
        })();
    </script>
    <style>
        /* å†…è”å…³é”®è·¯å¾„ CSS é¿å…é—ªçƒ - ä½¿ç”¨CSSå˜é‡æ”¯æŒä¸»é¢˜åˆ‡æ¢ */
        :root {
            --bg-primary: #0f0f1a;
            --text-primary: #e8e8f0;
        }
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
        }
    </style>
</head>

<body>
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <a href="/" class="navbar__brand">
            <span class="navbar__brand-icon">ğŸ¬</span>
            <span>è¿½æ¼«é˜</span>
        </a>
        <div class="navbar__nav">
            <a href="/" class="navbar__link {% if request.path == '/' %}active{% endif %}">é¦–é¡µ</a>
            <a href="/settings" class="navbar__link {% if request.path == '/settings' %}active{% endif %}">âš™ï¸ è®¾ç½®</a>
            <div class="navbar__theme-selector">
                <button class="navbar__theme-toggle" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
                <div class="navbar__theme-dropdown" id="theme-dropdown">
                    <div class="theme-dropdown__header">
                        <span>ğŸ¨ é…è‰²æ–¹æ¡ˆ</span>
                        <button class="theme-dropdown__close" onclick="toggleThemeDropdown()">&times;</button>
                    </div>
                    <div class="theme-dropdown__modes">
                        <button class="theme-mode-btn theme-mode-btn--dark active" onclick="ThemeManager.setMode('dark')">
                            <span>ğŸŒ™</span> æ·±è‰²
                        </button>
                        <button class="theme-mode-btn theme-mode-btn--light" onclick="ThemeManager.setMode('light')">
                            <span>â˜€ï¸</span> æµ…è‰²
                        </button>
                    </div>
                    <div class="theme-dropdown__themes">
                        <button class="theme-btn" data-theme="neon-purple" onclick="ThemeManager.setTheme('neon-purple')">
                            <span class="theme-btn__color" style="background: linear-gradient(135deg, #8b5cf6, #d8b4fe)"></span>
                            <span class="theme-btn__icon">ğŸ’œ</span>
                            <span class="theme-btn__name">éœ“è™¹ç´«</span>
                        </button>
                        <button class="theme-btn" data-theme="ocean-blue" onclick="ThemeManager.setTheme('ocean-blue')">
                            <span class="theme-btn__color" style="background: linear-gradient(135deg, #0ea5e9, #38bdf8)"></span>
                            <span class="theme-btn__icon">ğŸŒŠ</span>
                            <span class="theme-btn__name">æµ·æ´‹è“</span>
                        </button>
                        <button class="theme-btn" data-theme="sunset-orange" onclick="ThemeManager.setTheme('sunset-orange')">
                            <span class="theme-btn__color" style="background: linear-gradient(135deg, #f97316, #fb923c)"></span>
                            <span class="theme-btn__icon">ğŸŒ…</span>
                            <span class="theme-btn__name">æ—¥è½æ©™</span>
                        </button>
                        <button class="theme-btn" data-theme="emerald-green" onclick="ThemeManager.setTheme('emerald-green')">
                            <span class="theme-btn__color" style="background: linear-gradient(135deg, #10b981, #2dd4bf)"></span>
                            <span class="theme-btn__icon">ğŸ’š</span>
                            <span class="theme-btn__name">ç¿¡ç¿ ç»¿</span>
                        </button>
                        <button class="theme-btn" data-theme="sakura-pink" onclick="ThemeManager.setTheme('sakura-pink')">
                            <span class="theme-btn__color" style="background: linear-gradient(135deg, #ec4899, #f472b6)"></span>
                            <span class="theme-btn__icon">ğŸŒ¸</span>
                            <span class="theme-btn__name">æ¨±èŠ±ç²‰</span>
                        </button>
                    </div>
                </div>
            </div>
            <a href="/logout" class="navbar__link" style="opacity:0.6;font-size:0.85rem;">ğŸšª é€€å‡º</a>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹ -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <!-- æ¨¡æ€æ¡†å®¹å™¨ -->
    <div id="sources-modal-overlay" class="modal-overlay" onclick="if(event.target===this)closeSourcesModal()">
        <div class="modal">
            <div class="modal__header">
                <h3 class="modal__title">è§†é¢‘æº</h3>
                <button class="modal__close" onclick="closeSourcesModal()">&times;</button>
            </div>
            <div class="modal__body" id="sources-modal-body"></div>
        </div>
    </div>

    <!-- Toast å®¹å™¨ -->
    <div id="toast-container" class="toast-container"></div>

    <script src="{{ url_for('static', filename='app.js') }}?v=5"></script>
    {% block scripts %}{% endblock %}
</body>

</html>
