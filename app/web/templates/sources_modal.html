<!-- è§†é¢‘æºæ¨¡æ€æ¡†å†…å®¹ (é€šè¿‡ AJAX åŠ è½½) -->
{% if sources|length > 0 %}
<div style="margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;">
    <span style="color:var(--text-muted);font-size:0.85rem;">
        {{ anime.title_cn }} Â· ç¬¬{{ episode.absolute_num }}é›† Â· å…± {{ sources|length }} ä¸ªè§†é¢‘æº
    </span>
    <button class="btn btn--secondary btn--sm" onclick="findSources({{ anime.id }}, {{ episode.absolute_num }}, true)">
        ğŸ”„ é‡æ–°æœç´¢
    </button>
</div>

{% for source in sources %}
<div class="source-item">
    <div class="source-item__info">
        <div class="source-item__title">{{ source.title }}</div>
        <div class="source-item__meta">
            <span>ğŸ“º {{ source.channel_name or 'æœªçŸ¥é¢‘é“' }}</span>
            <span>â±ï¸ {{ source.duration_fmt }}</span>
            <span>ğŸ‘ï¸ {{ source.view_count_fmt }}</span>
            {% if source.published_at %}
            <span>ğŸ“… {{ source.published_at }}</span>
            {% endif %}
        </div>
    </div>

    <div class="source-item__score
        {% if source.match_score >= 70 %}source-item__score--high
        {% elif source.match_score >= 50 %}source-item__score--medium
        {% else %}source-item__score--low{% endif %}">
        {{ "%.0f"|format(source.match_score) }}åˆ†
    </div>

    <a href="{{ source.youtube_url }}" target="_blank" rel="noopener" class="source-item__link">
        â–¶ æ’­æ”¾
    </a>
</div>
{% endfor %}

{% else %}
<div style="text-align:center;padding:40px;">
    <div style="font-size:2.5rem;margin-bottom:12px;opacity:0.5;">ğŸ”</div>
    <div style="color:var(--text-secondary);margin-bottom:16px;">æš‚æ— è§†é¢‘æº</div>
    <button class="btn btn--primary btn--sm" onclick="findSources({{ anime.id }}, {{ episode.absolute_num }})">
        ğŸ” æœç´¢è§†é¢‘æº
    </button>
</div>
{% endif %}